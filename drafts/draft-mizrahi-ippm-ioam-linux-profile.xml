<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<!-- [

<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC2629 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2629.xml">
<!ENTITY RFC3552 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3552.xml">
<!ENTITY RFC5226 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5226.xml">
]>
-->
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc strict="yes" ?>
<?rfc toc="yes"?>
<?rfc tocdepth="4"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>
<rfc category="info" docName="draft-mizrahi-ippm-ioam-linux-profile-00"
     ipr="trust200902">
  <front>
    <title abbrev="IOAM Linux Profile">In Situ OAM Profile for the Linux
    Kernel Implementation</title>

    <author fullname="Tal Mizrahi" initials="T." surname="Mizrahi">
      <organization abbrev="">Huawei</organization>

      <address>
        <postal>
          <street>8-2 Matam</street>

          <city>Haifa</city>

          <country>Israel</country>
        </postal>

        <email>tal.mizrahi.phd@gmail.com</email>
      </address>
    </author>

    <author fullname="Justin Iurman" initials="J." surname="Iurman">
      <organization abbrev="">Universite de Liege</organization>

      <address>
        <email>justin.iurman@uliege.be</email>
      </address>
    </author>

    <date year="2021"/>

    <area>General</area>

    <workgroup>Network Working Group</workgroup>

    <keyword>IOAM</keyword>

    <abstract>
      <t>In Situ Operations, Administration and Maintenance (IOAM) is used for
      monitoring network performance and for detecting traffic bottlenecks and
      anomalies. This document defines an IOAM profile that is used in the
      Linux kernel implementation, starting from the Linux 5.14 kernel.</t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>IOAM <xref target="I-D.ietf-ippm-ioam-data"/> is used for monitoring
      traffic in the network by incorporating IOAM data fields into in-flight
      data packets.</t>

      <t>An IOAM profile <xref target="I-D.mizrahi-ippm-ioam-profile"/>
      defines a use case or a set of use cases for IOAM, and an associated set
      of rules that restrict the scope and features of the IOAM specification,
      thereby limiting it to a subset of the full functionality.</t>

      <t>This document introduces a profile of IOAM that is used in the Linux
      kernel implementation. The profile is intended to formally specify the
      subset of features that are in scope, and to enable other
      implementations to interoperate with the Linux implementation.</t>
    </section>

    <section title="The Linux IOAM Profile">
      <section title="Use Cases">
        <t>The Linux kernel implementation enables the functionality of any of
        the following nodes:</t>

        <t><list style="symbols">
            <t>IOAM encapsulating node</t>

            <t>IOAM transit node</t>

            <t>IOAM decapsulating node</t>
          </list></t>

        <t>One possible use case is a set of Linux-based hosts that function
        as IOAM encapsulating and decapsulating nodes, interconnected by IOAM
        transit nodes that are not necessarily Linux-based. Thus, Linux-based
        implementations are expected to interoperate with other implemenations
        that comply to this profile.</t>

        <t>Another possible use case is a homogenous setting in which all IOAM
        nodes are Linux-based.</t>
      </section>

      <section title="IOAM Version">
        <t>The current profile is based on <xref
        target="I-D.ietf-ippm-ioam-data-12"/>, which is a work-in-progress
        version of IOAM.</t>
      </section>

      <section title="IOAM Options">
        <t>The current profile uses the Pre-allocated Trace Option. It is
        assumed that one IOAM option is used in an IOAM encapsulated
        packet.</t>
      </section>

      <section title="Encapsulation">
        <t>The IOAM encapsulation uses an IPv6 Extension Header. This
        extension header is used for the IOAM Pre-allocated Trace Option, as
        defined in <xref target="I-D.ietf-ippm-ioam-ipv6-options-05"/>, which
        is a work-in-progress version of the IPv6 IOAM option.</t>

        <t>The IPv6 Extension Header is a Hop-by-Hop Options header, that
        contains the IOAM trace option. The Hop-by-Hop Options header can
        include one or more options, such that one of these options is the IOAM
        Pre-allocated Trace Option. <xref target="EHFig"/> illustrates the
        format of this Hop-by-Hop Options header when the IOAM Pre-allocated
        Trace Option is the only Hop-by-Hop option. If more options are
        present the format will change accordingly.</t>

        <t>As illustrated in <xref target="EHFig"/>, the first 2 octets are
        the Hop-by-Hop Options header <xref target="RFC8200"/>, followed by a
        2 octet Padding field (two Pad1 options). The following 4 octets are
        the IOAM IPv6 option header <xref
        target="I-D.ietf-ippm-ioam-ipv6-options-05"/>. The IOAM Option
        includes the 8 octet Pre-allocated Trace Option header <xref
        target="I-D.ietf-ippm-ioam-data-12"/>, followed by the Option
        Data.</t>

        <figure align="center" anchor="EHFig"
                title="IPv6 IOAM Extension Header Format">
          <artwork align="left"><![CDATA[
		  
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Next Header  |  Hdr Ext Len  |            Padding            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<-+
   |  Option Type  |  Opt Data Len |   Reserved    |   IOAM Type   |  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  I
   |        Namespace-ID           |NodeLen  | Flags | RemainingLen|  O
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  A
   |               IOAM-Trace-Type                 |  Reserved     |  M
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  .
   |                                                               |  .
   .                                                               .  .
   .                          Option Data                          .  O
   .                                                               .  P
   .                                                               .  T
   .                                                               .  I
   .                                                               .  O
   .                                                               .  N
   |                                                               |  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<-+
	  ]]></artwork>
        </figure>
      </section>

      <section title="IOAM Supported Data Fields">
        <t>The current profile supports all the data field types that are
        defined in <xref target="I-D.ietf-ippm-ioam-data-12"/> for the
        Pre-allocated Trace option, except for the Checksum Complement field,
        which is not required in this profile, since the IOAM Trace Option is
        encapsulated directly in an IPv6 Extension Header, without any
        additional layers that use a checksum.</t>

        <t>Note that the Linux implementation does not update the Transit
        Delay, Buffer Occupancy and Queue Depth fields when functioning as an
        IOAM transit node. However, when functioning as an IOAM encapsulating
        or decapsulating node, the Linux implementation can add/remove the
        Pre-allocated Trace option including these fields if configured to do
        so, and can interoperate with other IOAM nodes that support these
        fields.</t>
      </section>

      <section title="IOAM Option Pre-allocated Trace Header Flags">
        <t>This profile does not use any of the IOAM flags other than the
        Overflow flag.</t>
      </section>

      <section title="Opaque State Snapshot">
        <t>This profile supports the Opaque State Snapshot option.</t>
      </section>

      <section title="Timestamp Format">
        <t>This profile uses the POSIX timestamp format.</t>
      </section>

      <section title="Profile Coexistence">
        <t>It is assumed that the current profile is used in a confined
        administrative domain in which no other IOAM profiles are used.
        Therefore, it is assumed that the current profile does not coexist
        with other profiles.</t>
      </section>

      <section title="Validity">
        <t>An IOAM transit/decapsulating node that receives a packet with IOAM
        options that do not comply to the current profile is expected to
        forward/decapsulate the packet without IOAM processing, if it is able
        to do so. If a decapsulating node is not able to decapsulate an IOAM
        option that is not compliant to the current profile, the packet is
        discarded.</t>
      </section>
    </section>

    <section anchor="IANA" title="IANA Considerations">
      <t>This document does not include any requests from IANA.</t>
    </section>

    <section anchor="Security" title="Security Considerations">
      <t>The security considerations of IOAM profiles are discussed in <xref
      target="I-D.mizrahi-ippm-ioam-profile"/>. The current document does not
      present any new security considerations.</t>
    </section>
  </middle>

  <!--  *****BACK MATTER ***** -->

  <back>
    <references title="Normative References">
      <?rfc include='reference.RFC.2119'?>

      <?rfc include='reference.RFC.2473'?>

      <?rfc include='reference.RFC.8200'?>

      <!--?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml"?-->

      <!--&RFC2119;-->

      <?rfc include='reference.I-D.ietf-ippm-ioam-data'?>

      <?rfc include='reference.I-D.mizrahi-ippm-ioam-profile'?>

      <reference anchor="I-D.ietf-ippm-ioam-data-12">
        <front>
          <title>Data Fields for In-situ OAM</title>

          <author fullname="Frank Brockners" initials="F." surname="Brockners">
            <organization>Cisco Systems, Inc.</organization>
          </author>

          <author fullname="Shwetha Bhandari" initials="S." surname="Bhandari">
            <organization>Thoughtspot</organization>
          </author>

          <author fullname="Tal Mizrahi" initials="T." surname="Mizrahi">
            <organization>Huawei</organization>
          </author>

          <date day="21" month="February" year="2021"/>

          <abstract>
            <t>In-situ Operations, Administration, and Maintenance (IOAM)
            records operational and telemetry information in the packet while
            the packet traverses a path between two points in the network.
            This document discusses the data fields and associated data types
            for in-situ OAM. In-situ OAM data fields can be encapsulated into
            a variety of protocols such as NSH, Segment Routing, Geneve, IPv6
            (via extension header), or IPv4. In-situ OAM can be used to
            complement OAM mechanisms based on e.g. ICMP or other types of
            probe packets.</t>
          </abstract>
        </front>

        <seriesInfo name="Internet-Draft" value="draft-ietf-ippm-ioam-data-12"/>

        <format target="https://www.ietf.org/archive/id/draft-ietf-ippm-ioam-data-12.txt"
                type="TXT"/>
      </reference>

      <reference anchor="I-D.ietf-ippm-ioam-ipv6-options-05">
        <front>
          <title>In-situ OAM IPv6 Options</title>

          <author fullname="Shwetha Bhandari" initials="S." surname="Bhandari">
            <organization>Thoughtspot</organization>
          </author>

          <author fullname="Frank Brockners" initials="F." surname="Brockners">
            <organization>Cisco Systems, Inc.</organization>
          </author>

          <author fullname="Carlos Pignataro" initials="C."
                  surname="Pignataro">
            <organization>Cisco Systems, Inc.</organization>
          </author>

          <author fullname="Hannes Gredler" initials="H." surname="Gredler">
            <organization>RtBrick Inc.</organization>
          </author>

          <author fullname="John Leddy" initials="J." surname="Leddy">
            <organization>Comcast</organization>
          </author>

          <author fullname="Stephen Youell" initials="S." surname="Youell">
            <organization>JP Morgan Chase</organization>
          </author>

          <author fullname="Tal Mizrahi" initials="T." surname="Mizrahi">
            <organization>Huawei Network.IO Innovation Lab</organization>
          </author>

          <author fullname="Aviv Kfir" initials="A." surname="Kfir">
            <organization>Mellanox Technologies, Inc.</organization>
          </author>

          <author fullname="Barak Gafni" initials="B." surname="Gafni">
            <organization>Mellanox Technologies, Inc.</organization>
          </author>

          <author fullname="Petr Lapukhov" initials="P." surname="Lapukhov">
            <organization>Facebook</organization>
          </author>

          <author fullname="Mickey Spiegel" initials="M." surname="Spiegel">
            <organization>Barefoot Networks, an Intel company</organization>
          </author>

          <author fullname="Suresh Krishnan" initials="S." surname="Krishnan">
            <organization>Kaloom</organization>
          </author>

          <author fullname="Rajiv Asati" initials="R." surname="Asati">
            <organization>Cisco Systems, Inc.</organization>
          </author>

          <author fullname="Mark Smith" initials="M." surname="Smith"/>

          <date day="21" month="February" year="2021"/>

          <abstract>
            <t>In-situ Operations, Administration, and Maintenance (IOAM)
            records operational and telemetry information in the packet while
            the packet traverses a path between two points in the network.
            This document outlines how IOAM data fields are encapsulated in
            IPv6.</t>
          </abstract>
        </front>

        <seriesInfo name="Internet-Draft"
                    value="draft-ietf-ippm-ioam-ipv6-options-05"/>

        <format target="https://www.ietf.org/archive/id/draft-ietf-ippm-ioam-ipv6-options-05.txt"
                type="TXT"/>
      </reference>
    </references>

    <!-- Change Log

   -->
  </back>
</rfc>
