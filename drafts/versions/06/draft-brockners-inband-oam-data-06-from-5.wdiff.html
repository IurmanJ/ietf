<html><head><title>wdiff draft-brockners-inband-oam-data-05.txt draft-brockners-inband-oam-data-06.txt</title></head><body>
<pre>




ippm                                                        F. Brockners
Internet-Draft                                               S. Bhandari
Intended status: <strike><font color='red'>Experimental</font></strike> <strong><font color='green'>Standards Track</font></strong>                            C. Pignataro
Expires: <strike><font color='red'>November 30,</font></strike> <strong><font color='green'>December 28,</font></strong> 2017                                         Cisco
                                                              H. Gredler
                                                            RtBrick Inc.
                                                                J. Leddy
                                                                 Comcast
                                                               S. Youell
                                                                    JPMC
                                                              T. Mizrahi
                                                                 Marvell
                                                                D. Mozes
                                              Mellanox Technologies Ltd.
                                                             P. Lapukhov
                                                                Facebook
                                                                R. Chang
                                                       Barefoot Networks
                                                              D. Bernier
                                                             Bell Canada
                                                            <strike><font color='red'>May 29,</font></strike>
                                                           <strong><font color='green'>June 26,</font></strong> 2017


                      Data Fields for In-situ OAM
                   <strike><font color='red'>draft-brockners-inband-oam-data-05</font></strike>
                   <strong><font color='green'>draft-brockners-inband-oam-data-06</font></strong>

Abstract

   In-situ Operations, Administration, and Maintenance (IOAM) records
   operational and telemetry information in the packet while the packet
   traverses a path between two points in the network.  This document
   discusses the data fields and associated data types for in-situ OAM.
   In-situ OAM data fields can be embedded into a variety of transports
   such as NSH, Segment Routing, Geneve, native IPv6 (via extension
   header), or IPv4.  In-situ OAM can be used to complement OAM
   mechanisms based on e.g.  ICMP or other types of probe packets.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.





Brockners, et al.       Expires <strike><font color='red'>November 30,</font></strike> <strong><font color='green'>December 28,</font></strong> 2017               [Page 1]

Internet-Draft           In-situ OAM Data Fields                <strike><font color='red'>May</font></strike>               <strong><font color='green'>June</font></strong> 2017


   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on <strike><font color='red'>November 30,</font></strike> <strong><font color='green'>December 28,</font></strong> 2017.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   3
   2.  Conventions . . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Scope, Applicability, and Assumptions . . . . . . . . . . . .   4
   4.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> Data Types and Formats . . . . . . . . . . . . . <strong><font color='green'>. . . .</font></strong>   5
     4.1.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> Tracing Options  . . . . . . . . . . . . . . . <strong><font color='green'>. . .</font></strong>   6
       4.1.1.  Pre-allocated Trace Option  . . . . . . . . . . . . .   8
       4.1.2.  Incremental Trace Option  . . . . . . . . . . . . . .  11
       4.1.3.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> node data fields and associated formats  .  <strike><font color='red'>13</font></strike> <strong><font color='green'>. . .  14</font></strong>
       4.1.4.  Examples of <strike><font color='red'>In-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> node data  . . . . . . . . . .  <strike><font color='red'>17</font></strike> <strong><font color='green'>. . .  19</font></strong>
     4.2.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> Proof of Transit Option  . . . . . . . . . . .  <strike><font color='red'>19</font></strike> <strong><font color='green'>. . .  21</font></strong>
     4.3.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> Edge-to-Edge Option  . . . . . . . . . . . . .  <strike><font color='red'>21</font></strike> <strong><font color='green'>. . .  23</font></strong>
   5.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> Data Export  . . . . . . . . . . . . . . . . . . .  <strike><font color='red'>21</font></strike> <strong><font color='green'>. . .  23</font></strong>
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <strike><font color='red'>22</font></strike>  <strong><font color='green'>24
     6.1.  Creation of a New In-Situ OAM
           (IOAM) Protocol Parameters IANA registry  . . . . . . . .  24</font></strong>
   7.  Manageability Considerations  . . . . . . . . . . . . . . . .  <strike><font color='red'>22</font></strike>  <strong><font color='green'>24</font></strong>
   8.  Security Considerations . . . . . . . . . . . . . . . . . . .  <strike><font color='red'>22</font></strike>  <strong><font color='green'>24</font></strong>
   9.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  <strike><font color='red'>22</font></strike>  <strong><font color='green'>24</font></strong>
   10. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <strike><font color='red'>22</font></strike>  <strong><font color='green'>24</font></strong>
     10.1.  Normative References . . . . . . . . . . . . . . . . . .  <strike><font color='red'>22</font></strike>  <strong><font color='green'>24</font></strong>
     10.2.  Informative References . . . . . . . . . . . . . . . . .  <strike><font color='red'>23</font></strike>  <strong><font color='green'>25</font></strong>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <strike><font color='red'>24</font></strike>  <strong><font color='green'>26</font></strong>





Brockners, et al.       Expires <strike><font color='red'>November 30,</font></strike> <strong><font color='green'>December 28,</font></strong> 2017               [Page 2]

Internet-Draft           In-situ OAM Data Fields                <strike><font color='red'>May</font></strike>               <strong><font color='green'>June</font></strong> 2017


1.  Introduction

   This document defines data fields for "in-situ" Operations,
   Administration, and Maintenance <strike><font color='red'>(OAM).</font></strike> <strong><font color='green'>(IOAM).</font></strong>  In-situ OAM records OAM
   information within the packet while the packet traverses a particular
   network domain.  The term "in-situ" refers to the fact that the OAM
   data is added to the data packets rather than is being sent within
   packets specifically dedicated to OAM.  A discussion of the
   motivation and requirements for in-situ OAM can be found in
   [I-D.brockners-inband-oam-requirements].  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> is to complement
   mechanisms such as Ping or Traceroute, or more recent active probing
   mechanisms as described in [I-D.lapukhov-dataplane-probe].  In terms
   of "active" or "passive" OAM, "in-situ" OAM can be considered a
   hybrid OAM type.  While no extra packets are sent, <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> adds
   information to the packets therefore cannot be considered passive.
   In terms of the classification given in [RFC7799] <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> could be
   portrayed as
   <strike><font color='red'>"hybrid OAM, type 1".</font></strike> <strong><font color='green'>Hybrid Type 1.</font></strong>  "In-situ" mechanisms do not require
   extra packets to be sent and hence don't change the packet traffic
   mix within the network.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> mechanisms can be leveraged where
   mechanisms using e.g.  ICMP do not apply or do not offer the desired
   results, such as proving that a certain traffic flow takes a pre-
   defined path, SLA verification for the live data traffic, detailed
   statistics on traffic distribution paths in networks that distribute
   traffic across multiple paths, or scenarios in which probe traffic is
   potentially handled differently from regular data traffic by the
   network devices.

2.  Conventions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

   Abbreviations used in this document:

   <strong><font color='green'>E2E        Edge to Edge</font></strong>

   Geneve:    Generic Network Virtualization Encapsulation
              [I-D.ietf-nvo3-geneve]

   IOAM:      In-situ Operations, Administration, and Maintenance

   MTU:       Maximum Transmit Unit

   NSH:       Network Service Header [I-D.ietf-sfc-nsh]

   OAM:       Operations, Administration, and Maintenance

   <strike><font color='red'>SFC:       Service Function Chain</font></strike>




Brockners, et al.       Expires <strike><font color='red'>November 30,</font></strike> <strong><font color='green'>December 28,</font></strong> 2017               [Page 3]

Internet-Draft           In-situ OAM Data Fields                <strike><font color='red'>May</font></strike>               <strong><font color='green'>June</font></strong> 2017


   <strong><font color='green'>POT:       Proof of Transit

   SFC:       Service Function Chain</font></strong>

   SID:       Segment Identifier

   SR:        Segment Routing

   VXLAN-GPE: Virtual eXtensible Local Area Network, Generic Protocol
              Extension [I-D.ietf-nvo3-vxlan-gpe]

3.  Scope, Applicability, and Assumptions

   <strike><font color='red'>In-situ OAM</font></strike>

   <strong><font color='green'>IOAM</font></strong> deployment assumes a set of constraints, requirements, and
   guiding principles which are described in this section.

   Scope: This document defines the data fields and associated data
   types for in-situ OAM.  The in-situ OAM data field can be transported
   by a variety of transport protocols, including NSH, Segment Routing,
   Geneve, IPv6, or IPv4.  <strike><font color='red'>Encapsulation</font></strike>  <strong><font color='green'>Specification</font></strong> details for these different
   transport protocols are outside the scope of this document.

   Deployment domain (or scope) of in-situ OAM deployment: IOAM is a
   network domain focused feature, with "network domain" being a set of
   network devices or entities within a single administration.  For
   example, a network domain can include an enterprise campus using
   physical connections between devices or an overlay network using
   virtual connections / tunnels for connectivity between said devices.
   A network domain is defined by its perimeter or edge.  Designers of
   carrier protocols for IOAM must specify mechanisms to ensure that <strike><font color='red'>in-
   situ OAM</font></strike>
   <strong><font color='green'>IOAM</font></strong> data stays within an IOAM domain.  In addition, the operator of
   such a domain is expected to put provisions in place to ensure that
   IOAM data does not leak beyond the edge of an IOAM domain, e.g. using
   for example packet filtering methods.  The operator should consider
   potential operational impact of IOAM to mechanisms such as ECMP
   processing (e.g.  load-balancing schemes based on packet length could
   be impacted by the increased packet size due to IOAM), path MTU (i.e.
   ensure that the MTU of all links within a domain is sufficiently
   large to support the increased packet size due to IOAM) and ICMP
   message handling (i.e. in case of a native IPv6 transport, IOAM
   support for ICMPv6 Echo Request/Reply could desired which would
   translate into ICMPv6 extensions to enable IOAM data fields to be
   copied from an Echo Request message to an Echo Reply message).

   <strike><font color='red'>In-situ OAM</font></strike>

   <strong><font color='green'>IOAM</font></strong> control points: IOAM data fields are added to or removed from
   the live user traffic by the devices which form the edge of a domain.
   Devices within an IOAM domain can update and/or add IOAM data-fields.
   Domain edge devices can be hosts or network devices.



<strong><font color='green'>Brockners, et al.       Expires December 28, 2017               [Page 4]

Internet-Draft           In-situ OAM Data Fields               June 2017</font></strong>


   Traffic-sets that <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> is applied to: IOAM can be deployed on all or
   only on subsets of the live user traffic.  It SHOULD be possible to
   enable <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> on a selected set of traffic (e.g.,



<strike><font color='red'>Brockners, et al.       Expires November 30, 2017               [Page 4]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike> per interface, based
   on an access control list or flow specification defining a specific
   set of traffic, etc.)  The selected set of traffic can also be all
   traffic.

   Encapsulation independence: Data formats for <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> SHOULD be defined
   in a transport-independent manner.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> applies to a variety of
   encapsulating protocols.  A definition of how IOAM data fields are
   carried by different transport protocols is outside the scope of this
   document.

   Layering: If several encapsulation protocols (e.g., in case of
   tunneling) are stacked on top of each other, <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data-records could
   be present at every layer.  The behavior follows the <strike><font color='red'>ships-in-
   the-night</font></strike> <strong><font color='green'>ships-in-the-
   night</font></strong> model.

   Combination with active OAM mechanisms: <strike><font color='red'>In-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> should be usable for
   active network probing, enabling for example a customized version of
   traceroute.  Decapsulating <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> nodes may have an ability to send the <strike><font color='red'>in-situ OAM</font></strike>
   <strong><font color='green'>IOAM</font></strong> information retrieved from the packet back to the source address
   of the packet or to the encapsulating node.

   <strike><font color='red'>In-situ OAM</font></strike>

   <strong><font color='green'>IOAM</font></strong> implementation: The IOAM data-field definitions take the
   specifics of devices with hardware data-plane and software data-plane
   into account.

4.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> Data Types and Formats

   This section defines <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data types and data fields and associated
   data types required for <strike><font color='red'>in-situ OAM.</font></strike> <strong><font color='green'>IOAM.</font></strong>  The different uses of <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> require the
   definition of different types of data.  The <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data fields for the
   data being carried corresponds to the three main categories of <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong>
   data defined in [I-D.brockners-inband-oam-requirements], which are:
   edge-to-edge, per node, and for selected nodes only.

   Transport options for <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data are outside the scope of this memo,
   and are discussed in [I-D.brockners-inband-oam-transport].  <strike><font color='red'>In-
   situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> data
   fields are fixed length data fields.  A bit field determines the set
   of OAM data fields embedded in a packet.  Depending on the type of
   the encapsulation, a counter field indicates how many data fields are
   included in a particular packet.

   <strike><font color='red'>In-situ OAM</font></strike>

   <strong><font color='green'>IOAM</font></strong> is expected to be deployed in a specific domain rather than on
   the overall Internet.  The part of the network which employs
   <strike><font color='red'>in- situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> is
   referred to as the <strike><font color='red'>"in-situ OAM-domain".  In-situ OAM</font></strike> <strong><font color='green'>"IOAM-domain".  IOAM</font></strong> data is added to a packet
   upon entering the <strike><font color='red'>in-situ OAM-domain</font></strike> <strong><font color='green'>IOAM-domain</font></strong> and is removed from the packet when



<strong><font color='green'>Brockners, et al.       Expires December 28, 2017               [Page 5]

Internet-Draft           In-situ OAM Data Fields               June 2017</font></strong>


   exiting the domain.  Within the <strike><font color='red'>in-situ
   OAM-domain,</font></strike> <strong><font color='green'>IOAM-domain,</font></strong> the <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data may be
   updated by network nodes that



<strike><font color='red'>Brockners, et al.       Expires November 30, 2017               [Page 5]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike> the packet traverses.  The device which
   adds an <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data container to the packet to capture <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data is
   called the
   <strike><font color='red'>"in-situ OAM</font></strike> <strong><font color='green'>"IOAM</font></strong> encapsulating node", whereas the device which
   removes the <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data container is referred to as the <strike><font color='red'>"in-situ OAM</font></strike> <strong><font color='green'>"IOAM</font></strong>
   decapsulating node".  Nodes within the domain which are aware of <strike><font color='red'>in-
   situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong>
   data and read and/or write or process the <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data are called <strike><font color='red'>"in-situ OAM</font></strike> <strong><font color='green'>"IOAM</font></strong>
   transit nodes".  <strong><font color='green'>IOAM nodes which add or remove the IOAM data
   container can also update the IOAM data fields at the same time.  Or
   in other words, IOAM encapsulation or decapsulating nodes can also
   serve as IOAM transit nodes at the same time.</font></strong>  Note that not every
   node in an <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> domain needs to be an <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> transit node.  For
   example, a Segment Routing deployment might require the segment
   routing path to be verified.  In that case, only the SR nodes would
   also be <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> transit nodes rather than all nodes.

4.1.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> Tracing Options

   <strike><font color='red'>"In-situ OAM</font></strike>

   <strong><font color='green'>"IOAM</font></strong> tracing data" is expected to be collected at every node that a
   packet <strike><font color='red'>traverses,</font></strike> <strong><font color='green'>traverses to ensure visibility into the entire path a packet
   takes within an IOAM domain,</font></strong> i.e., in a typical deployment all nodes
   in an in-situ OAM-domain would participate in <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> and thus be
   <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong>
   transit nodes, <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> encapsulating or <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> decapsulating nodes.  <strong><font color='green'>If
   not all nodes within a domain are IOAM capable, IOAM tracing
   information will only be collected on those nodes which are IOAM
   capable.  Nodes which are not IOAM capable will forward the packet
   without any changes to the IOAM data fields.</font></strong>  The maximum number of
   hops and the minimum path MTU of the <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> domain is assumed to be
   known.

   To optimize hardware and software implementations tracing is defined
   as two separate options.  Any deployment MAY choose to configure and
   support one or both of the following options.  An implementation of
   the transport protocol that carries these in-situ OAM data MAY choose
   to support only one of the options.  In the event that both options
   are utilized at the same time, the Incremental Trace Option MUST be
   placed before the Pre-allocated Trace Option.  <strong><font color='green'>Given that the
   operator knows which equipment is deployed in a particular IOAM, the
   operator will decide by means of configuration which type(s) of trace
   options will be enabled for a particular domain.</font></strong>

   Pre-allocated Trace Option:  This trace option is defined as a
      container of node data fields with pre-allocated space for each
      node to populate its information.  This option is useful for
      software implementations where it is efficient to allocate the
      space once and index into the array to populate the data during
      transit.  The <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> encapsulating node allocates the option header
      and sets the fields in the option header.  The in situ OAM



<strong><font color='green'>Brockners, et al.       Expires December 28, 2017               [Page 6]

Internet-Draft           In-situ OAM Data Fields               June 2017</font></strong>


      encapsulating node allocates an array which is used to store
      operational data retrieved from every node while the packet
      traverses the domain.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> transit nodes update the content of
      the array.  A pointer which is part of the <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> trace data points
      to the next empty slot in the array, which is where the next <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong>
      transit node fills in its data.

   Incremental Trace Option:  This trace option is defined as a
      container of node data fields where each node allocates and pushes
      its node data immediately following the option header.  The <strike><font color='red'>number
      of node data fields recorded and</font></strike>
      maximum <strike><font color='red'>number</font></strike> <strong><font color='green'>length</font></strong> of <strong><font color='green'>the</font></strong> node data <strike><font color='red'>that
      can be recorded are</font></strike> <strong><font color='green'>list is</font></strong> written into the option
      header.  This type of



<strike><font color='red'>Brockners, et al.       Expires November 30, 2017               [Page 6]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike> trace recording is useful for some of the
      hardware implementations as this eliminates the need for the
      transit network elements to read the full array in the option and
      allows for arbitrarily long packets as the MTU allows.  The <strike><font color='red'>in-situ</font></strike> <strong><font color='green'>in-
      situ</font></strong> OAM encapsulating node allocates the option header.  The <strike><font color='red'>in-situ</font></strike> <strong><font color='green'>in-
      situ</font></strong> OAM encapsulating node based on operational state and
      configuration sets the fields in the header to control how large
      the node data list can grow.  <strike><font color='red'>In-
      situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> transit nodes push their node
      data to the node data list and increment the number of node data
      fields in the header.

   Every node data entry is to hold information for a particular <strike><font color='red'>in-situ
   OAM</font></strike> <strong><font color='green'>IOAM</font></strong>
   transit node that is traversed by a packet.  The in-situ OAM
   decapsulating node removes the <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data and processes and/or exports
   the metadata.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> data uses its own name-space for information such
   as node identifier or interface identifier.  This allows for a
   domain-specific definition and interpretation.  For example: In one
   case an interface-id could point to a physical interface (e.g., to
   understand which physical interface of an aggregated link is used
   when receiving or transmitting a packet) whereas in another case it
   could refer to a logical interface (e.g., in case of tunnels).

   The following <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data is defined for <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> tracing:

   o  Identification of the <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> node.  An <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> node identifier can
      match to a device identifier or a particular control point or
      subsystem within a device.

   o  Identification of the interface that a packet was received <strike><font color='red'>on.</font></strike> <strong><font color='green'>on,
      i.e. ingress interface.</font></strong>

   o  Identification of the interface that a packet was sent out <strike><font color='red'>on.</font></strike> <strong><font color='green'>on,
      i.e. egress interface.</font></strong>

   o  Time of day when the packet was processed by the node.  Different
      definitions of processing time are feasible and expected, though
      <strike><font color='red'>it is important that</font></strike>




<strong><font color='green'>Brockners, et al.       Expires December 28, 2017               [Page 7]

Internet-Draft           In-situ OAM Data Fields               June 2017


      it is important that</font></strong> all devices of an in-situ OAM domain follow
      the same definition.

   o  Generic data: Format-free information where syntax and semantic of
      the information is defined by the operator in a specific
      deployment.  For a specific deployment, all <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> nodes should
      interpret the generic data the same way.  Examples for generic <strike><font color='red'>in-situ OAM</font></strike>
      <strong><font color='green'>IOAM</font></strong> data include geo-location information (location of the node
      at the time the packet was processed), buffer queue fill level or
      cache fill level at the time the packet was processed, or even a
      battery charge level.






<strike><font color='red'>Brockners, et al.       Expires November 30, 2017               [Page 7]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike>

   o  A mechanism to detect whether <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> trace data was added at every
      hop or whether certain hops in the domain weren't in-situ OAM
      transit nodes.

   The "node data list" array in the packet is populated iteratively as
   the packet traverses the network, starting with the last entry of the
   array, i.e., "node data list [n]" is the first entry to be populated,
   "node data list [n-1]" is the second one, etc.

4.1.1.  Pre-allocated Trace Option





























<strong><font color='green'>Brockners, et al.       Expires December 28, 2017               [Page 8]

Internet-Draft</font></strong>           In-situ OAM <strong><font color='green'>Data Fields               June 2017


   In-situ OAM pre-allocated trace option:</font></strong>

   Pre-allocated <strike><font color='red'>Trace Option:

   Pre-allocated Trace Option</font></strike> <strong><font color='green'>trace option</font></strong> header:

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         IOAM-Trace-Type       |  Octets-left  |     Flags     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Pre-allocated Trace Option Data MUST be <strike><font color='red'>4-byte</font></strike> <strong><font color='green'>4-octet</font></strong> aligned:
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+&lt;-+
   |                                                               |  |
   |                        node data list [0]                     |  |
   |                                                               |  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  D
   |                                                               |  a
   |                        node data list [1]                     |  t
   |                                                               |  a
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                             ...                               ~  S
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  p
   |                                                               |  a
   |                        node data list [n-1]                   |  c
   |                                                               |  e
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
   |                                                               |  |
   |                        node data list [n]                     |  |
   |                                                               |  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+&lt;-+



   IOAM-Trace-Type:  A 16-bit identifier which specifies which data
      types are used in this node data list.





<strike><font color='red'>Brockners, et al.       Expires November 30, 2017               [Page 8]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike>

      The IOAM-Trace-Type value is a bit field.  The following bit
      fields are defined in this document, with details on each field
      described in the Section 4.1.3.  The order of packing the data
      fields in each node data element follows the bit order of the
      IOAM-Trace-Type field, as follows:

      Bit 0    <strike><font color='red'>(Least</font></strike>    <strong><font color='green'>(Most</font></strong> significant bit) When set indicates presence of
               Hop_Lim and node_id in the node data.

      Bit 1    When set indicates presence of ingress_if_id and
               egress_if_id (short format) in the node data.




<strong><font color='green'>Brockners, et al.       Expires December 28, 2017               [Page 9]

Internet-Draft           In-situ OAM Data Fields               June 2017</font></strong>


      Bit 2    When set indicates presence of timestamp seconds in the
               node data

      Bit 3    When set indicates presence of timestamp nanoseconds in
               the node data.

      Bit 4    When set indicates presence of transit delay in the node
               data.

      Bit 5    When set indicates presence of app_data (short format) in
               the node data.

      Bit 6    When set indicates presence of queue depth in the node
               data.

      Bit 7    When set indicates presence of variable length Opaque
               State Snapshot field.

      Bit 8    When set indicates presence of Hop_Lim and node_id in
               wide format in the node data.

      Bit 9    When set indicates presence of ingress_if_id and
               egress_if_id in wide format in the node data.

      Bit 10   When set indicates presence of app_data wide in the node
               data.

      Bit <strike><font color='red'>11-15</font></strike> <strong><font color='green'>11   When set indicates presence of the Checksum Complement
               node data.

      Bit 12-15</font></strong>  Undefined in this draft.

      Section <strike><font color='red'>4.1.4</font></strike> <strong><font color='green'>4.1.3</font></strong> describes the <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data types and their formats.
      Within an in-situ OAM domain possible combinations of these bits
      making the IOAM-Trace-Type can be restricted by configuration
      knobs.






<strike><font color='red'>Brockners, et al.       Expires November 30, 2017               [Page 9]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike>

   Octets-left:  8-bit unsigned integer.  It is the data space in octets
      remaining for recording the node data.  This is used as an offset
      in octets in data space to record node data element.

   Flags  8-bit field.  The following flags are defined:

      Bit 0  "Overflow" (O-bit) (most significant bit).  This bit is set
         by the network element if there is not enough number of <strike><font color='red'>bytes</font></strike> <strong><font color='green'>octets</font></strong>
         left to record node data, no field is added and the overflow
         "O-bit" must be set to "1" in the header.  This is useful for
         transit nodes to ignore further processing of the option.



<strong><font color='green'>Brockners, et al.       Expires December 28, 2017              [Page 10]

Internet-Draft           In-situ OAM Data Fields               June 2017</font></strong>


      Bit 1  "Loopback" (L-bit).  Loopback mode is used to send a copy
         of a packet back towards the source.  Loopback mode assumes
         that a return path from transit nodes and destination nodes
         towards the source exists.  The encapsulating node decides
         (e.g. using a filter) which packets loopback mode is enabled
         for by setting the loopback bit.  The encapsulating node also
         needs to ensure that sufficient space is available in the IOAM
         header for loopback operation.  The loopback bit when set
         indicates to the transit nodes processing this option to create
         a copy of the packet received and send this copy of the packet
         back to the source of the packet while it continues to forward
         the original packet towards the destination.  The source
         address of the original packet is used as destination address
         in the copied packet.  The address of the node performing the
         copy operation is used as the source address.  The L-bit MUST
         be cleared in the copy of the packet a nodes sends it back
         towards the source.  On its way back towards the source, the
         packet is processed like a regular packet with IOAM
         information.  Once the return packet reaches the IOAM domain
         boundary IOAM decapsulation occurs as with any other packet
         containing IOAM information.

      <strong><font color='green'>Bit 2-7  Reserved: Must be zero.</font></strong>

   Node data List [n]:  Variable-length field.  The type of which is
      determined by the IOAM-Trace-Type representing the n-th node data
      in the node data list.  The node data list is encoded starting
      from the last node data of the path.  The first element of the
      node data list (node data list [0]) contains the last node of the
      path while the last node data of the node data list (node data
      list[n]) contains the first node data of the path traced.  The
      index contained in "Octets-left" identifies the offset for current
      active node data to be populated.

<strong><font color='green'>4.1.2.  Incremental Trace Option</font></strong>
















Brockners, et al.       Expires <strike><font color='red'>November 30,</font></strike> <strong><font color='green'>December 28,</font></strong> 2017              [Page <strike><font color='red'>10]</font></strike> <strong><font color='green'>11]</font></strong>

Internet-Draft           In-situ OAM Data Fields                <strike><font color='red'>May</font></strike>               <strong><font color='green'>June</font></strong> 2017


<strike><font color='red'>4.1.2.  Incremental Trace Option</font></strike>


   In-situ OAM <strike><font color='red'>Incremental Trace Option:</font></strike> <strong><font color='green'>incremental trace option:</font></strong> '

   In-situ OAM <strike><font color='red'>Incremental Trace Option</font></strike> <strong><font color='green'>incremental trace option</font></strong> Header:

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        IOAM-Trace-Type        | Maximum Length|    Flags      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   <strike><font color='red'>In-situ OAM</font></strike>

   <strong><font color='green'>IOAM</font></strong> Incremental Trace Option Data MUST be <strike><font color='red'>4-byte</font></strike> <strong><font color='green'>4-octet</font></strong> aligned:

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                        node data list [0]                     |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                        node data list [1]                     |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                             ...                               ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                        node data list [n-1]                   |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                        node data list [n]                     |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+



   IOAM-trace-type:  A 16-bit identifier which specifies which data
      types are used in this node data list.

      The IOAM-Trace-Type value is a bit field.  The following bit
      fields are defined in this document, with details on each field
      described in the Section 4.1.3.  The order of packing the data
      fields in each node data element follows the bit order of the
      IOAM-Trace-Type field, as follows:

      Bit 0    <strong><font color='green'>(Most significant bit)</font></strong> When set indicates presence of
               Hop_Lim and node_id in the node data.




<strike><font color='red'>Brockners, et al.       Expires November 30, 2017              [Page 11]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike>

      Bit 1    When set indicates presence of ingress_if_id and
               egress_if_id <strong><font color='green'>(short format)</font></strong> in the node data.



<strong><font color='green'>Brockners, et al.       Expires December 28, 2017              [Page 12]

Internet-Draft           In-situ OAM Data Fields               June 2017</font></strong>


      Bit 2    When set indicates presence of timestamp seconds in the
               node data.

      Bit 3    When set indicates presence of timestamp nanoseconds in
               the node data.

      Bit 4    When set indicates presence of transit delay in the node
               data.

      Bit 5    When set indicates presence of app_data in the node data.

      Bit 6    When set indicates presence of queue depth in the node
               data.

      Bit 7    When set indicates presence of variable length Opaque
               State Snapshot field.

      Bit 8    When set indicates presence of Hop_Lim and node_id wide
               in the node data.

      Bit 9    When set indicates presence of ingress_if_id and
               egress_if_id <strong><font color='green'>in</font></strong> wide <strong><font color='green'>format</font></strong> in the node data.

      Bit 10   When set indicates presence of app_data wide in the node
               data.

      Bit <strike><font color='red'>11-15</font></strike> <strong><font color='green'>11   When set indicates presence of the Checksum Complement
               node data.

      Bit 12-15</font></strong>  Undefined in this draft.

      Section <strike><font color='red'>4.1.4</font></strike> <strong><font color='green'>4.1.3</font></strong> describes the <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data types and their formats.

   Maximum Length:  8-bit unsigned integer.  This field specifies the
      maximum length of the node data list in octets.  Given that the
      sender knows the minimum path MTU, the sender can set the maximum
      of node data <strike><font color='red'>bytes</font></strike> <strong><font color='green'>octets</font></strong> allowed before exceeding the MTU.  <strike><font color='red'>Thus,</font></strike>  <strong><font color='green'>It is
      assumed that every protocol that IOAM can be encapsulated over
      will include</font></strong> a
      <strike><font color='red'>simple comparison between "Opt</font></strike> <strong><font color='green'>shim header that includes a field describing the
      current length of the IOAM</font></strong> data <strike><font color='red'>Len" and "Max</font></strike> <strong><font color='green'>fields.  In which case the
      "current length of the IOAM data fields" combined with the
      "Maximum</font></strong> Length" allows to decide whether or not data could be
      added.

   Flags  8-bit field.  Following flags are defined:

      Bit 0  "Overflow" (O-bit) (least significant bit).  This bit is
         set by the network element if there is not enough number of
         <strike><font color='red'>bytes left to record node</font></strike>



<strong><font color='green'>Brockners, et al.       Expires December 28, 2017              [Page 13]

Internet-Draft           In-situ OAM Data Fields               June 2017


         octets left to record node</font></strong> data, no field is added and the
         overflow "O-bit" must be set to "1" in the header.  This is




<strike><font color='red'>Brockners, et al.       Expires November 30, 2017              [Page 12]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike>
         useful for transit nodes to ignore further processing of the
         option.

      Bit 1  "Loopback" (L-bit).  This bit when set indicates to the
         transit nodes processing this option to send a copy of the
         packet back to the source of the packet while it continues to
         forward the original packet towards the destination.  The L-bit
         MUST be cleared in the copy of the packet before sending it.

      <strong><font color='green'>Bit 2-7  Reserved.  Must be zero.</font></strong>

   Node data List [n]:  Variable-length field.  The type of which is
      determined by the OAM Type representing the n-th node data in the
      node data list.  The node data list is encoded starting from the
      last node data of the path.  The first element of the node data
      list (node data list [0]) contains the last node of the path while
      the last node data of the node data list (node data list[n])
      contains the first node data of the path traced.

4.1.3.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> node data fields and associated formats

   All the data fields MUST be <strike><font color='red'>4-byte</font></strike> <strong><font color='green'>4-octet</font></strong> aligned.  The IOAM encapsulating
   node MUST initialize data fields that it adds to the packet to zero.
   If a node which is supposed to update an IOAM data field is not
   capable of populating the value of a field set in the IOAM-Trace-
   Type, the field value MUST be left unaltered except when explicitly
   specified in the field description below.  In the description of data
   below if zero is valid value then a non-zero value to mean not
   populated is specified.

   Data field and associated data type for each of the data field is
   shown below:

   Hop_Lim and node_id:  4-octet field defined as follows:

    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Hop_Lim     |              node_id                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      Hop_Lim:  1-octet unsigned integer.  It is set to the Hop Limit
         value in the packet at the node that records this data.  Hop
         Limit information is used to identify the location of the node
         in the communication path.  This is copied from the lower
         layer, e.g., TTL value in IPv4 header or hop limit field from
         IPv6 header of the packet when the packet is ready for



<strong><font color='green'>Brockners, et al.       Expires December 28, 2017              [Page 14]

Internet-Draft           In-situ OAM Data Fields               June 2017</font></strong>


         transmission.  <strong><font color='green'>The semantics of the Hop_Lim field depend on the
         lower layer protocol that IOAM is encapsulated over, and
         therefore its specific semantics are outside the scope of this
         memo.</font></strong>

      node_id:  3-octet unsigned integer.  Node identifier field to
         uniquely identify a node within in-situ OAM domain.  The



<strike><font color='red'>Brockners, et al.       Expires November 30, 2017              [Page 13]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike>
         procedure to allocate, manage and map the node_ids is beyond
         the scope of this document.

   ingress_if_id and egress_if_id:  4-octet field defined as follows:
      When this field is part of the data field but a node populating
      the field is not able to fill it, the position in the field must
      be filled with value 0xFFFFFFFF to mean not populated.

    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     ingress_if_id             |         egress_if_id          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      ingress_if_id:  2-octet unsigned integer.  Interface identifier to
         record the ingress interface the packet was received on.

      egress_if_id:  2-octet unsigned integer.  Interface identifier to
         record the egress interface the packet is forwarded out of.

   timestamp seconds:  4-octet unsigned integer.  Absolute timestamp in
      seconds that specifies the time at which the packet was received
      by the node.  The structure of this field is identical to the most
      significant 32 bits of the 64 least significant bits of the
      [IEEE1588v2] timestamp.  This truncated field consists of a 32-bit
      seconds field.  As defined in [IEEE1588v2], the timestamp
      specifies the number of seconds elapsed since 1 January 1970
      00:00:00 according to the International Atomic Time (TAI).

    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       timestamp seconds                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   timestamp nanoseconds:  4-octet unsigned integer in the range 0 to
      10^9-1.  This timestamp specifies the fractional part of the wall
      clock time at which the packet was received by the node in units
      of nanoseconds.  This field is identical to the 32 least
      significant bits of the [IEEE1588v2] timestamp.  This fields
      allows for delay computation between any two nodes in the network
      when the nodes are time synchronized.  When this field is part of
      the data field but a node populating the field is not able to fill



<strong><font color='green'>Brockners, et al.       Expires December 28, 2017              [Page 15]

Internet-Draft           In-situ OAM Data Fields               June 2017</font></strong>


      it, the field position in the field must be filled with value
      0xFFFFFFFF to mean not populated.

    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       timestamp nanoseconds                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+



<strike><font color='red'>Brockners, et al.       Expires November 30, 2017              [Page 14]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike>

   transit delay:  4-octet unsigned integer in the range 0 to 2^30-1.
      It is the time in nanoseconds the packet spent in the transit
      node.  This can serve as an indication of the queuing delay at the
      node.  If the transit delay exceeds 2^30-1 nanoseconds then the
      top bit 'O' is set to indicate overflow.  When this field is part
      of the data field but a node populating the field is not able to
      fill it, the field position in the field must be filled with value
      0xFFFFFFFF to mean not populated.

    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |O|                     transit delay                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   app_data:  4-octet placeholder which can be used by the node to add
      application specific <strike><font color='red'>data</font></strike> <strong><font color='green'>data.  App_data represents a "free-format"
      4-octet bit field with its semantics defined by a specific
      deployment.

    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       app_data                                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</font></strong>

   queue depth:  4-octet unsigned integer field.  This field indicates
      the current length of the egress interface queue of the interface
      from where the packet is forwarded out.  The queue depth is
      expressed as the current number of memory buffers used by the
      queue (a packet may consume one or more memory buffers, depending
      on its size).  When this field is part of the data field but a
      node populating the field is not able to fill it, the field
      position in the field must be filled with value 0xFFFFFFFF to mean
      not populated.

    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       queue depth                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+





<strong><font color='green'>Brockners, et al.       Expires December 28, 2017              [Page 16]

Internet-Draft           In-situ OAM Data Fields               June 2017</font></strong>


   Opaque State Snapshot:  Variable length field.  It allows the network
      element to store an arbitrary state in the node data field ,
      without a pre-defined schema.  The schema needs to be made known
      to the analyzer by some out-of-band mechanism.  The specification
      of this mechanism is beyond the scope of this document.  The
      24-bit "Schema Id" field in the field indicates which particular
      schema is used, and should be configured on the network element by
      the operator.











<strike><font color='red'>Brockners, et al.       Expires November 30, 2017              [Page 15]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike>

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |   Length      |                     Schema ID                 |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      |                                                               |
      |                        Opaque data                            |
      ~                                                               ~
      .                                                               .
      .                                                               .
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      Length:  1-octet unsigned integer.  It is the length in octets of
         the Opaque data field that follows Schema Id.  It MUST always
         be a multiple of 4.

      Schema ID:  3-octet unsigned integer identifying the schema of
         Opaque data.

      Opaque data:  Variable length field.  This field is interpreted as
         specified by the schema identified by the Schema ID.

   Hop_Lim and node_id wide:  8-octet field defined as follows:

    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Hop_Lim     |              node_id                          ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                         node_id (contd)                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      Hop_Lim:  1-octet unsigned integer.  It is set to the Hop Limit
         value in the packet at the node that records this data.  Hop
         Limit information is used to identify the location of the node
         in the communication path.  This is copied from the lower layer
         for e.g.  TTL value in IPv4 header or hop limit field from IPv6
         header of the packet.  <strong><font color='green'>The semantics of the Hop_Lim field
         depend on the lower layer protocol that IOAM is encapsulated



Brockners, et al.       Expires December 28, 2017              [Page 17]

Internet-Draft           In-situ OAM Data Fields               June 2017


         over, and therefore its specific semantics are outside the
         scope of this memo.</font></strong>

      node_id:  7-octet unsigned integer.  Node identifier field to
         uniquely identify a node within in-situ OAM domain.  The
         procedure to allocate, manage and map the node_ids is beyond
         the scope of this document.

   ingress_if_id and egress_if_id wide:  8-octet field defined as
      follows: When this field is part of the data field <strike><font color='red'>but</font></strike> <strong><font color='green'>but a node
      populating the field is not able to fill it, the field position in
      the field must be filled with value 0xFFFFFFFFFFFFFFFF to mean not
      populated.

    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       ingress_if_id                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       egress_if_id                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      ingress_if_id:  4-octet unsigned integer.  Interface identifier to
         record the ingress interface the packet was received on.

      egress_if_id:  4-octet unsigned integer.  Interface identifier to
         record the egress interface the packet is forwarded out of.

   app_data wide:  8-octet placeholder which can be used by the node to
      add application specific data.  App data represents a "free-
      format" 8-octed bit field with its semantics defined by a specific
      deployment.

    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       app data                                ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                       app data (contd)                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Checksum Complement:  4-octet node data which contains a two-octet
      Checksum Complement field, and a 2-octet reserved field.  The
      Checksum Complement can be used when IOAM is transported over
      encapsulations that make use of a UDP transport, such as VXLAN-GPE
      or Geneve.  In this case, incorporating the IOAM node data
      requires the UDP Checksum field to be updated.  Rather than to
      recompute the Chekcsum field,</font></strong> a node
      <strike><font color='red'>populating</font></strike> <strong><font color='green'>can use</font></strong> the <strike><font color='red'>field is not able</font></strike> <strong><font color='green'>Checksum
      Complement</font></strong> to <strike><font color='red'>fill it, the field position</font></strike> <strong><font color='green'>make a checksum-neutral update</font></strong> in <strong><font color='green'>the UDP payload;
      the Checksum Complement is assigned a value that complements the</font></strong>



Brockners, et al.       Expires <strike><font color='red'>November 30,</font></strike> <strong><font color='green'>December 28,</font></strong> 2017              [Page <strike><font color='red'>16]</font></strike> <strong><font color='green'>18]</font></strong>

Internet-Draft           In-situ OAM Data Fields                <strike><font color='red'>May</font></strike>               <strong><font color='green'>June</font></strong> 2017


      <strong><font color='green'>rest of the node data fields that were added by</font></strong> the <strong><font color='green'>current node,
      causing the existing UDP Checksum</font></strong> field <strike><font color='red'>must be filled with value 0xFFFFFFFF</font></strike> to <strike><font color='red'>mean not
      populated.</font></strike> <strong><font color='green'>remain correct.
      Checksum Complement fields are used in a similar manner in
      [RFC7820] and [RFC7821].</font></strong>

    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7
   8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       <strike><font color='red'>ingress_if_id                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</font></strike>      <strong><font color='green'>Checksum Complement</font></strong>      |                       <strike><font color='red'>egress_if_id</font></strike>           <strong><font color='green'>Reserved</font></strong>            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      <strike><font color='red'>ingress_if_id:  4-octet unsigned integer.  Interface identifier to
         record the ingress interface the packet was received on.

      egress_if_id:  4-octet unsigned integer.  Interface identifier to
         record the egress interface the packet is forwarded out of.

   app_data wide:  8-octet placeholder which can be used by the node to
      add application specific data.</font></strike>

4.1.4.  Examples of <strike><font color='red'>In-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> node data

   An entry in the "node data list" array can have different formats,
   following the needs of the deployment.  Some deployments might only
   be interested in recording the node identifiers, whereas others might
   be interested in recording node identifier and timestamp.  The
   section defines different types that an entry in "node data list" can
   take.

   0x002B:  IOAM-Trace-Type is 0x2B then the format of node data is:

        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   Hop_Lim     |              node_id                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     ingress_if_id             |         egress_if_id          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                  timestamp nanoseconds                        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            app_data                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   0x0003:  IOAM-Trace-Type is 0x0003 then the format is:








<strike><font color='red'>Brockners, et al.       Expires November 30, 2017              [Page 17]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike>

        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   Hop_Lim     |              node_id                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     ingress_if_id             |         egress_if_id          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+



   0x0009:  IOAM-Trace-Type is 0x0009 then the format is:





<strong><font color='green'>Brockners, et al.       Expires December 28, 2017              [Page 19]

Internet-Draft           In-situ OAM Data Fields               June 2017</font></strong>


        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   Hop_Lim     |              node_id                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                   timestamp nanoseconds                       |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   0x0021:  IOAM-Trace-Type is 0x0021 then the format is:

        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   Hop_Lim     |              node_id                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            app_data                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   0x0029:  IOAM-Trace-Type is 0x0029 then the format is:

        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   Hop_Lim     |              node_id                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                    timestamp nanoseconds                      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            app_data                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   0x018C:  IOAM-Trace-Type is 0x104D then the format is:




















Brockners, et al.       Expires <strike><font color='red'>November 30,</font></strike> <strong><font color='green'>December 28,</font></strong> 2017              [Page <strike><font color='red'>18]</font></strike> <strong><font color='green'>20]</font></strong>

Internet-Draft           In-situ OAM Data Fields                <strike><font color='red'>May</font></strike>               <strong><font color='green'>June</font></strong> 2017


        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                      timestamp seconds                        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                    timestamp nanoseconds                      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   Length      |                     Schema Id                 |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       |                                                               |
       |                        Opaque data                            |
       ~                                                               ~
       .                                                               .
       .                                                               .
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   Hop_Lim     |              node_id                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                         node_id(contd)                        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


4.2.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> Proof of Transit Option

   <strike><font color='red'>In-situ OAM</font></strike>

   <strong><font color='green'>IOAM</font></strong> Proof of Transit data is to support the path or service function
   chain [RFC7665] verification use cases.  Proof-of-transit uses
   methods like nested hashing or nested encryption of the <strike><font color='red'>in-situ
   OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data or
   mechanisms such as Shamir's Secret Sharing Schema (SSSS).  While
   details on how the <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data for the proof of transit option is
   processed at <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> encapsulating, decapsulating and transit nodes are
   outside the scope of the document, all of these approaches share the
   need to uniquely identify a packet as well as iteratively operate on
   a set of information that is handed from node to node.
   Correspondingly, two pieces of information are added as <strike><font color='red'>in-
   situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data to
   the packet:

   o  Random: Unique identifier for the packet (e.g., 64-bits allow for
      the unique identification of 2^64 packets).

   o  Cumulative: Information which is handed from node to node and
      updated by every node according to a verification algorithm.











Brockners, et al.       Expires <strike><font color='red'>November 30,</font></strike> <strong><font color='green'>December 28,</font></strong> 2017              [Page <strike><font color='red'>19]</font></strike> <strong><font color='green'>21]</font></strong>

Internet-Draft           In-situ OAM Data Fields                <strike><font color='red'>May</font></strike>               <strong><font color='green'>June</font></strong> 2017


   <strike><font color='red'>In-situ OAM Proof</font></strike>


   <strong><font color='green'>IOAM proof</font></strong> of <strike><font color='red'>Transit Option:

   In-situ OAM Proof</font></strike> <strong><font color='green'>transit option:

   IOAM proof</font></strong> of <strike><font color='red'>Transit Option Header:</font></strike> <strong><font color='green'>transit option header:</font></strong>

    0 1 2 3 4 5 6 7
   +-+-+-+-+-+-+-+-+
   |IOAM POT Type|P|
   +-+-+-+-+-+-+-+-+

   <strike><font color='red'>In-situ OAM Proof</font></strike>

   <strong><font color='green'>IOAM proof</font></strong> of <strike><font color='red'>Transit Option Data</font></strike> <strong><font color='green'>transit option data</font></strong> MUST be <strike><font color='red'>4-byte</font></strike> <strong><font color='green'>4-octet</font></strong> aligned:

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+&lt;-+
   |                           Random                              |  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  P
   |                        Random(contd)                          |  O
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  T
   |                         Cumulative                            |  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |
   |                         Cumulative (contd)                    |  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+&lt;-+



   IOAM POT Type:  7-bit identifier of a particular POT variant that
      dictates the POT data that is included.  This document defines POT
      Type 0:

      0: POT data is a 16 Octet field as described below.

   Profile to use (P):  1-bit.  Indicates which POT-profile is used to
      generate the Cumulative.  Any node participating in POT will have
      a maximum of 2 profiles configured that drive the computation of
      cumulative.  The two profiles are numbered 0, 1.  This bit conveys
      whether profile 0 or profile 1 is used to compute the Cumulative.

   Random:  64-bit Per packet Random number.

   Cumulative:  64-bit Cumulative that is updated at specific nodes by
      processing per packet Random number field and configured
      parameters.

   Note: Larger or smaller sizes of "Random" and "Cumulative" data are
   feasible and could be required for certain deployments (e.g.  in case
   of space constraints in the transport protocol used).  Future
   versions of this document will address different sizes of data for
   "proof of transit".



Brockners, et al.       Expires <strike><font color='red'>November 30,</font></strike> <strong><font color='green'>December 28,</font></strong> 2017              [Page <strike><font color='red'>20]</font></strike> <strong><font color='green'>22]</font></strong>

Internet-Draft           In-situ OAM Data Fields                <strike><font color='red'>May</font></strike>               <strong><font color='green'>June</font></strong> 2017


4.3.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> Edge-to-Edge Option

   The <strike><font color='red'>in-situ OAM Edge-to-Edge Option</font></strike> <strong><font color='green'>IOAM edge-to-edge option</font></strong> is to carry data that is added by the <strike><font color='red'>in-situ OAM</font></strike>
   <strong><font color='green'>IOAM</font></strong> encapsulating node and interpreted by <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> decapsulating node.
   The <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> transit nodes MAY process the data without modifying it.

   Currently only sequence numbers use the <strike><font color='red'>in-situ OAM Edge-to-Edge</font></strike> <strong><font color='green'>IOAM edge-to-edge</font></strong> option.  In
   order to detect packet loss, packet reordering, or packet duplication
   in an in-situ OAM-domain, sequence numbers can be added to packets of
   a particular tube (see [I-D.hildebrand-spud-prototype]).  Each tube
   leverages a dedicated namespace for its sequence numbers.

     <strike><font color='red'>In-situ OAM Edge-to-Edge Option:

      In-situ OAM Edge-to-Edge Option Header:</font></strike>

     <strong><font color='green'>IOAM edge-to-edge option:

      IOAM edge-to-edge option header:</font></strong>

       0 1 2 3 4 5 6 7
      +-+-+-+-+-+-+-+-+
      | IOAM-E2E-Type |
      +-+-+-+-+-+-+-+-+

      <strike><font color='red'>In-situ OAM Edge-to-Edge Option Data</font></strike>

      <strong><font color='green'>IOAM edge-to-edge option data</font></strong> MUST be <strike><font color='red'>4-byte</font></strike> <strong><font color='green'>4-octet</font></strong> aligned:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |       E2E Option data field determined by IOAM-E2E-Type       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   IOAM-E2E-Type:  8-bit identifier of a particular in situ OAM E2E
      variant.

         0: E2E option data is a 64-bit sequence number added to a
         specific tube which is used to identify packet loss and
         reordering for that tube.

5.  <strike><font color='red'>In-situ OAM</font></strike>  <strong><font color='green'>IOAM</font></strong> Data Export

   <strike><font color='red'>In-situ OAM</font></strike>

   <strong><font color='green'>IOAM</font></strong> nodes collect information for packets traversing a domain that
   supports <strike><font color='red'>in-situ OAM.  The device at the domain edge (which
   could also be an end-host) which receives a packet with in-situ OAM
   information chooses how to process the in-situ OAM data collected
   within the packet.  This</font></strike> <strong><font color='green'>IOAM.  IOAM</font></strong> decapsulating <strike><font color='red'>node</font></strike> <strong><font color='green'>nodes as well as IOAM transit
   nodes</font></strong> can <strike><font color='red'>simply discard the</font></strike> <strong><font color='green'>choose to retrieve IOAM</font></strong> information <strike><font color='red'>collected, can</font></strike> <strong><font color='green'>from the packet,</font></strong>
   process the information <strike><font color='red'>further, or</font></strike> <strong><font color='green'>further and</font></strong> export the information using
   e.g., IPFIX.



<strike><font color='red'>Brockners, et al.       Expires November 30, 2017              [Page 21]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike>

   The discussion of <strike><font color='red'>in-situ OAM</font></strike> <strong><font color='green'>IOAM</font></strong> data processing and export is left for a
   future version of this document.




<strong><font color='green'>Brockners, et al.       Expires December 28, 2017              [Page 23]

Internet-Draft           In-situ OAM Data Fields               June 2017</font></strong>


6.  IANA Considerations

<strong><font color='green'>6.1.  Creation of a New In-Situ OAM (IOAM) Protocol Parameters IANA
      registry

   IANA is requested to create a new protocol registry for "In-Situ OAM
   (IOAM) Protocol Parameters".  This is the common registry that will
   include registrations for all IOAM namespaces.  The subsequent sub-
   sections detail the registries herein contained.</font></strong>

   IANA considerations will be <strike><font color='red'>added</font></strike> <strong><font color='green'>completed</font></strong> in a future version of this
   document.

7.  Manageability Considerations

   Manageability considerations will be addressed in a later version of
   this document..

8.  Security Considerations

   Security considerations will be addressed in a later version of this
   document.  For a discussion of security requirements of in-situ OAM,
   please refer to [I-D.brockners-inband-oam-requirements].

9.  Acknowledgements

   The authors would like to thank Eric Vyncke, Nalini Elkins, Srihari
   Raghavan, Ranganathan T S, Karthik Babu Harichandra Babu, Akshaya
   Nadahalli, LJ Wobker, Erik Nordmark, Vengada Prasad Govindan, and
   Andrew Yourtchenko for the comments and advice.

   This document leverages and builds on top of several concepts
   described in [I-D.kitamura-ipv6-record-route].  The authors would
   like to acknowledge the work done by the author Hiroshi Kitamura and
   people involved in writing it.

   <strong><font color='green'>The authors would like to gracefully acknowledge useful review and
   insightful comments received from Joe Clarke, Al Morton, and Mickey
   Spiegel.</font></strong>

10.  References

10.1.  Normative References








<strong><font color='green'>Brockners, et al.       Expires December 28, 2017              [Page 24]

Internet-Draft           In-situ OAM Data Fields               June 2017</font></strong>


   [I-D.brockners-inband-oam-requirements]
              Brockners, F., Bhandari, S., Dara, S., Pignataro, C.,
              Gredler, H., Leddy, J., Youell, S., Mozes, D., Mizrahi,
              T., &lt;&gt;, P., and r. remy@barefootnetworks.com,
              "Requirements for In-situ OAM", draft-brockners-inband-
              oam-requirements-03 (work in progress), March 2017.

   [IEEE1588v2]
              Institute of Electrical and Electronics Engineers,
              "1588-2008 - IEEE Standard for a Precision Clock
              Synchronization Protocol for Networked Measurement and
              Control Systems",  IEEE Std 1588-2008, 2008,
              &lt;http://standards.ieee.org/findstds/
              standard/1588-2008.html&gt;.



<strike><font color='red'>Brockners, et al.       Expires November 30, 2017              [Page 22]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike>

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              &lt;http://www.rfc-editor.org/info/rfc2119&gt;.

   [RFC7799]  Morton, A., "Active and Passive Metrics and Methods (with
              Hybrid Types In-Between)", RFC 7799, DOI 10.17487/RFC7799,
              May 2016, &lt;http://www.rfc-editor.org/info/rfc7799&gt;.

10.2.  Informative References

   [I-D.brockners-inband-oam-transport]
              Brockners, F., Bhandari, S., Govindan, V., Pignataro, C.,
              Gredler, H., Leddy, J., Youell, S., Mizrahi, T., Mozes,
              D., Lapukhov, P., and R. &lt;&gt;, "Encapsulations for In-situ
              OAM Data", draft-brockners-inband-oam-transport-03 (work
              in progress), March 2017.

   [I-D.hildebrand-spud-prototype]
              Hildebrand, J. and B. Trammell, "Substrate Protocol for
              User Datagrams (SPUD) Prototype", draft-hildebrand-spud-
              prototype-03 (work in progress), March 2015.

   [I-D.ietf-nvo3-geneve]
              Gross, J., Ganga, I., and T. Sridhar, "Geneve: Generic
              Network Virtualization Encapsulation", draft-ietf-
              nvo3-geneve-04 (work in progress), March 2017.

   [I-D.ietf-nvo3-vxlan-gpe]
              Maino, F., Kreeger, L., and U. Elzur, "Generic Protocol
              Extension for VXLAN", draft-ietf-nvo3-vxlan-gpe-04 (work
              in progress), April 2017.




<strong><font color='green'>Brockners, et al.       Expires December 28, 2017              [Page 25]

Internet-Draft           In-situ OAM Data Fields               June 2017</font></strong>


   [I-D.ietf-sfc-nsh]
              Quinn, P. and U. Elzur, "Network Service Header", draft-
              <strike><font color='red'>ietf-sfc-nsh-12</font></strike>
              <strong><font color='green'>ietf-sfc-nsh-13</font></strong> (work in progress), <strike><font color='red'>February</font></strike> <strong><font color='green'>June</font></strong> 2017.

   [I-D.kitamura-ipv6-record-route]
              Kitamura, H., "Record Route for IPv6 (PR6) Hop-by-Hop
              Option Extension", draft-kitamura-ipv6-record-route-00
              (work in progress), November 2000.

   [I-D.lapukhov-dataplane-probe]
              Lapukhov, P. and r. remy@barefootnetworks.com, "Data-plane
              probe for in-band telemetry collection", draft-lapukhov-
              dataplane-probe-01 (work in progress), June 2016.





<strike><font color='red'>Brockners, et al.       Expires November 30, 2017              [Page 23]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike>

   [RFC7665]  Halpern, J., Ed. and C. Pignataro, Ed., "Service Function
              Chaining (SFC) Architecture", RFC 7665,
              DOI 10.17487/RFC7665, October 2015,
              &lt;http://www.rfc-editor.org/info/rfc7665&gt;.

   <strong><font color='green'>[RFC7820]  Mizrahi, T., "UDP Checksum Complement in the One-Way
              Active Measurement Protocol (OWAMP) and Two-Way Active
              Measurement Protocol (TWAMP)", RFC 7820,
              DOI 10.17487/RFC7820, March 2016,
              &lt;http://www.rfc-editor.org/info/rfc7820&gt;.

   [RFC7821]  Mizrahi, T., "UDP Checksum Complement in the Network Time
              Protocol (NTP)", RFC 7821, DOI 10.17487/RFC7821, March
              2016, &lt;http://www.rfc-editor.org/info/rfc7821&gt;.</font></strong>

Authors' Addresses

   Frank Brockners
   Cisco Systems, Inc.
   Hansaallee 249, 3rd Floor
   DUESSELDORF, NORDRHEIN-WESTFALEN  40549
   Germany

   Email: fbrockne@cisco.com


   Shwetha Bhandari
   Cisco Systems, Inc.
   Cessna Business Park, Sarjapura Marathalli Outer Ring Road
   Bangalore, KARNATAKA 560 087
   India

   Email: shwethab@cisco.com




<strong><font color='green'>Brockners, et al.       Expires December 28, 2017              [Page 26]

Internet-Draft           In-situ OAM Data Fields               June 2017</font></strong>


   Carlos Pignataro
   Cisco Systems, Inc.
   7200-11 Kit Creek Road
   Research Triangle Park, NC  27709
   United States

   Email: cpignata@cisco.com


   Hannes Gredler
   RtBrick Inc.

   Email: hannes@rtbrick.com


   John Leddy
   Comcast

   Email: John_Leddy@cable.comcast.com







<strike><font color='red'>Brockners, et al.       Expires November 30, 2017              [Page 24]

Internet-Draft           In-situ OAM Data Fields                May 2017</font></strike>


   Stephen Youell
   JP Morgan Chase
   25 Bank Street
   London  E14 5JP
   United Kingdom

   Email: stephen.youell@jpmorgan.com


   Tal Mizrahi
   Marvell
   6 Hamada St.
   Yokneam  2066721
   Israel

   Email: talmi@marvell.com


   David Mozes
   Mellanox Technologies Ltd.

   Email: davidm@mellanox.com








<strong><font color='green'>Brockners, et al.       Expires December 28, 2017              [Page 27]

Internet-Draft           In-situ OAM Data Fields               June 2017</font></strong>


   Petr Lapukhov
   Facebook
   1 Hacker Way
   Menlo Park, CA  94025
   US

   Email: petr@fb.com


   Remy Chang
   Barefoot Networks
   2185 Park Boulevard
   Palo Alto, CA  94306
   US


   Daniel
   Bell Canada

   Email: daniel.bernier@bell.ca































Brockners, et al.       Expires <strike><font color='red'>November 30,</font></strike> <strong><font color='green'>December 28,</font></strong> 2017              [Page <strike><font color='red'>25]</font></strike> <strong><font color='green'>28]</font></strong>
</pre>
</body></html>
